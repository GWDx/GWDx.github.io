<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Hackergame 2021 题解 - GWDx</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="GWDx" /><meta name="description" content="Hackergame 2021（中科大第八届信息安全大赛）个人题解
" /><meta name="keywords" content="Hackergame" />






<meta name="generator" content="Hugo 0.123.8 with theme even" />


<link rel="canonical" href="http://gwdx.github.io/post/hackergame2021/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.8c29ea812462215a64664d7cc3441ba352b84557e1a6a570ffaf5d74e70242a4.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="Hackergame 2021 题解" />
<meta property="og:description" content="Hackergame 2021（中科大第八届信息安全大赛）个人题解
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://gwdx.github.io/post/hackergame2021/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-28T22:46:41+08:00" />

<meta itemprop="name" content="Hackergame 2021 题解">
<meta itemprop="description" content="Hackergame 2021（中科大第八届信息安全大赛）个人题解
"><meta itemprop="datePublished" content="2022-04-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-06-28T22:46:41+08:00" />
<meta itemprop="wordCount" content="3400">
<meta itemprop="keywords" content="Hackergame,CTF," /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Hackergame 2021 题解"/>
<meta name="twitter:description" content="Hackergame 2021（中科大第八届信息安全大赛）个人题解
"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">GWDx</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">GWDx</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Hackergame 2021 题解</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-04-01 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#环境">环境</a></li>
        <li><a href="#1-签到">1. 签到</a></li>
        <li><a href="#2-进制十六参上">2. 进制十六——参上</a></li>
        <li><a href="#3-去吧追寻自由的电波">3. 去吧！追寻自由的电波</a></li>
        <li><a href="#4-猫咪问答-pro-max">4. 猫咪问答 Pro Max</a></li>
        <li><a href="#5-卖瓜">5. 卖瓜</a></li>
        <li><a href="#6-透明的文件">6. 透明的文件</a></li>
        <li><a href="#7-旅行照片">7. 旅行照片</a></li>
        <li><a href="#8-flag-助力大红包">8. FLAG 助力大红包</a></li>
        <li><a href="#9-amnesia">9. Amnesia</a></li>
        <li><a href="#10-图之上的信息">10. 图之上的信息</a></li>
        <li><a href="#11-easy-rsa">11. Easy RSA</a></li>
        <li><a href="#13-赛博厨房">13. 赛博厨房</a></li>
        <li><a href="#14-灯等灯等灯">14. 灯，等灯等灯</a></li>
        <li><a href="#17-micro-world">17. Micro World</a></li>
        <li><a href="#23-马赛克">23. 马赛克</a></li>
        <li><a href="#25-密码生成器">25. 密码生成器</a></li>
        <li><a href="#27-just-be-fun">27. JUST BE FUN</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Hackergame 2021（中科大第八届信息安全大赛）个人题解</p>
<p><img src="/post/hackergame2021/image/board.png" alt="board"></p>
<table>
<thead>
<tr>
<th style="text-align:center">年份</th>
<th style="text-align:center">id</th>
<th style="text-align:center">分数</th>
<th style="text-align:center">总排名</th>
<th style="text-align:center">组内排名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2020</td>
<td style="text-align:center">3223</td>
<td style="text-align:center">1300</td>
<td style="text-align:center">297</td>
<td style="text-align:center">46</td>
</tr>
<tr>
<td style="text-align:center">2021</td>
<td style="text-align:center">450</td>
<td style="text-align:center">3100</td>
<td style="text-align:center">45</td>
<td style="text-align:center">7</td>
</tr>
</tbody>
</table>
<p>题目及其余题解见 <a href="https://github.com/USTC-Hackergame/hackergame2021-writeups">hackergame2021-writeups</a></p>
<h3 id="环境">环境</h3>
<ul>
<li>Ubuntu 20.04</li>
<li>Python 3.8</li>
<li>Mathematica 12</li>
</ul>
<h3 id="1-签到">1. 签到</h3>
<p>不是去年的检查元素。观察发现 URL 会变，于是用二分法。</p>
<h3 id="2-进制十六参上">2. 进制十六——参上</h3>
<p>用十六进制编辑器，例如 okteta。</p>
<p>这题的难点在于将十六进制数正确地输入编辑器，我就输错了很多次</p>
<h3 id="3-去吧追寻自由的电波">3. 去吧！追寻自由的电波</h3>
<p>一开始什么都听不出来，注意到题目中说</p>
<blockquote>
<p>录音的速度有所改变</p>
</blockquote>
<p>但是一般的慢放不行，需要修改采样率</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Audio</span><span class="p">[</span><span class="n">AudioData</span><span class="p">[</span><span class="n">audio</span><span class="p">][[</span><span class="mi">1</span><span class="p">]],</span><span class="w"> </span><span class="n">SampleRate</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">AudioSampleRate</span><span class="o">@</span><span class="n">audio</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然而还是听不懂，再查</p>
<blockquote>
<p>使用了无线电中惯用的方法来区分字符串中读音相近的字母，</p>
</blockquote>
<p>这是 <a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D%E8%A7%A3%E9%87%8A%E6%B3%95">字母解释法</a>。</p>
<h3 id="4-猫咪问答-pro-max">4. 猫咪问答 Pro Max</h3>
<ol>
<li>在 web archive 上找到历史内容	<a href="https://web.archive.org/web/20181004003308/http://sec.ustc.edu.cn/doku.php/codes">信息安全俱乐部社团章程</a></li>
<li>找到了 <a href="https://lug.ustc.edu.cn/wiki/intro">中国科学技术大学 Linux 用户协会介绍</a>，不过不能确定是 4 还是 5，因为没有更新 2021 年的情况</li>
<li><del>实地考察</del></li>
<li>找到相应的文档 <a href="http://sigbovik.org/2021/proceedings.pdf">SIGBOVIK 2021</a>，这篇文章的后 13 张图分别展示了一个数据集</li>
<li>查找该文档 <a href="https://datatracker.ietf.org/doc/html/rfc8962#section-6">IETF : Establishing the Protocol Police</a>，注意是阅读正文部分的 Reporting Offenses，而不是末尾的 Email</li>
</ol>
<h3 id="5-卖瓜">5. 卖瓜</h3>
<p>6 和 9 怎么凑出 20 ？当然是用溢出啦</p>
<p>经试验，在 6 的地方输入 <code>3000000000000000000</code>，然后在 9 的地方输入 <code>49638230412172404</code> 即可</p>
<h3 id="6-透明的文件">6. 透明的文件</h3>
<p>搜索 “cmd 打印 颜色”，找到了相似的内容：<a href="https://zhuanlan.zhihu.com/p/136173259">Python 打印带颜色的 log</a></p>
<p>在所有 <code>[</code> 前加 <code>\x1B</code>，然后再 <code>type</code>，然而并没有显示。</p>
<p>后来偶然间（为第 17 题装的 conda 导致环境变量有问题，错误提示恰好把前两行占掉了）发现运行命令后左边的文字有些不寻常，于是</p>
<center><img src="image/6.png" alt="6" width="50%" /></center>
<h3 id="7-旅行照片">7. 旅行照片</h3>
<p>查阅资料意识到根据街景识别几乎不可能。起初以为地点藏在图像的 Exif 数据里，虽然我看到了“未采取隐写措施”。</p>
<p>题目中多次出现了 “KFC”，我一开始就查到了但当时不认为是同一个，于是开始沿着海岸线找……</p>
<p>后来再次按照 “KFC 沙滩 停车场” 进行搜索，确认是秦皇岛的。用百度地图查电话号码，用全景查左侧的文字。不过剩下 3 个迟迟无法确定，最后是用 <code>pyautogui</code> 辅助点击枚举出来的。</p>
<h3 id="8-flag-助力大红包">8. FLAG 助力大红包</h3>
<p>点击助力按钮时，发送 POST 请求，请求内容包括 <code>IP</code>，直接修改此处的 IP 只会修改前端 IP，会提示 “前后端 IP 地址不匹配”。</p>
<p>搜索“后端 IP”，找到了 <a href="https://www.zhihu.com/question/264264051/answer/280132618">http 请求头部的 client_ip 是如何获取的？</a> ，其中提到 <code>X-Forwarded-For</code> 这个请求头。不过向目标网站发送的请求中并没有这个请求头。</p>
<p>而 <a href="https://blog.csdn.net/xxxcyzyy/article/details/93756574">伪造 HTTP 请求 IP 地址</a> 中说可以追加这个请求头。经测试，增加 <code>X-Forwarded-For</code> 可以修改后端 ip，于是编写代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://202.38.93.111:10888/invite/ec5a0b15-34af-4b79-a181-5635e416af80&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="n">ip</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x-forwarded-for&#39;</span><span class="p">:</span> <span class="n">ip</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="9-amnesia">9. Amnesia</h3>
<h4 id="1-轻度失忆">(1) 轻度失忆</h4>
<p>经过尝试，<code>printf</code> 不能用，而 <code>putchar</code> 可以使用。主要代码如下，完整程序见 <a href="code/9.cpp">9.cpp</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c4</span><span class="p">,</span> <span class="n">c16</span><span class="p">,</span> <span class="n">c96</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">comma</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">exclamation</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">c1</span> <span class="o">=</span> <span class="o">!</span><span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">c4</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">c16</span> <span class="o">=</span> <span class="n">c4</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">+</span> <span class="n">c4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">c96</span> <span class="o">=</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">H</span> <span class="o">=</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c16</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">+</span> <span class="n">c4</span><span class="p">;</span>    <span class="c1">// 72
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">e</span> <span class="o">=</span> <span class="n">c96</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">+</span> <span class="n">c1</span><span class="p">;</span>                      <span class="c1">// 101
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="nf">putchar</span><span class="p">(</span><span class="n">H</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">putchar</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>官方题解里说可以直接 <code>putchar</code> 字符</p>
</blockquote>
<h3 id="10-图之上的信息">10. 图之上的信息</h3>
<p>发现登录时 POST 请求了 graphql 文件</p>
<p>在了解 GraphQL 的语法，一开始以为和 SQL 注入有关，用“sql注入 graphql” 查到了 <a href="https://blog.csdn.net/wy_97/article/details/110522150">渗透测试之 graphQL</a></p>
<p>其中提到了内省查询 <code>__schema</code>。发送下面的 POST 请求可以查询到结构信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query IntrospectionQuery { __schema { queryType { name } mutationType { name } subscriptionType { name } types { ...FullType } directives { name description locations args { ...InputValue } } } } fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef } } fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue } fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } } }&#34;</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>响应内容中 <code>GUser</code> 有 <code>privateEmail</code> 字段，因此发送以下请求即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query{ user(id: 1){id username privateEmail}}&#34;</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="11-easy-rsa">11. Easy RSA</h3>
<blockquote>
<p>完整代码见 <a href="code/11/11.wl">11.wl</a>	<a href="code/11/11.py">11.py</a></p>
</blockquote>
<p>首先计算 <code>p</code> 。x 与 y 都是素数，可以使用 <a href="https://baike.baidu.com/item/%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86/1881444">威尔逊定理</a> $(p-1)! \equiv -1 \pmod{p}$</p>
<blockquote>
<p>注意是与 -1 同余，我一开始记成 1 了</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="c">(* 已知 e, x, y, valueLast, valueQ, c *)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fold</span><span class="p">[</span><span class="n">Mod</span><span class="p">[</span><span class="nv">#1</span><span class="w"> </span><span class="nv">#2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">Range</span><span class="p">[</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">inverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PowerMod</span><span class="p">[</span><span class="o">-</span><span class="n">product</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NextPrime</span><span class="o">@</span><span class="n">inverse</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>再计算 <code>q</code>。$prevQ^e \equiv valueQ \pmod{n}$，而 $n= \prod value_i$，故 $prevQ^e \equiv valueQ \pmod{value_i}$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="n">NextPrime</span><span class="p">[</span><span class="n">valueLast</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">-9</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Times</span><span class="w"> </span><span class="o">@@</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">prevQModValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="n">Echo</span><span class="o">@</span><span class="n">PowerMod</span><span class="p">[</span><span class="n">Mod</span><span class="p">[</span><span class="n">valueQ</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">prevQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ChineseRemainder</span><span class="p">[</span><span class="n">prevQModValue</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NextPrime</span><span class="o">@</span><span class="n">prevQ</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后参考 <a href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_theory/">RSA 介绍</a> 求出原数字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">phiN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">q</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PowerMod</span><span class="p">[</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">phiN</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PowerMod</span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>最后用以下 python 代码写 flag 文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;flag.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">bytes</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="13-赛博厨房">13. 赛博厨房</h3>
<h4 id="1-level-0">(1) LEVEL 0</h4>
<p>菜谱只会在 0, 1 之间变化，多保存几次就会刷新。参考代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">向右 1 步
</span></span><span class="line"><span class="cl">拿起 1 个物品
</span></span><span class="line"><span class="cl">向左 1 步
</span></span><span class="line"><span class="cl">向下 1 步
</span></span><span class="line"><span class="cl">放下 1 个物品
</span></span><span class="line"><span class="cl">向上 1 步
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">向右 2 步
</span></span><span class="line"><span class="cl">拿起 1 个物品
</span></span><span class="line"><span class="cl">向左 2 步
</span></span><span class="line"><span class="cl">向下 1 步
</span></span><span class="line"><span class="cl">放下 1 个物品
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2-level-1">(2) LEVEL 1</h4>
<p>需要 73 个物品 0，而最多限制 72 行。只能使用 <code>如果手上的物品大于等于 n 向上跳转 m 行</code> 这条语句。</p>
<blockquote>
<p>观察示例程序执行记录发现该语句是说代码跳 <code>m</code> 行，而不是说机器人移动多少步</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">向右 1 步
</span></span><span class="line"><span class="cl">拿起 73 个物品
</span></span><span class="line"><span class="cl">向左 1 步
</span></span><span class="line"><span class="cl">向下 1 步
</span></span><span class="line"><span class="cl">放下 1 个物品
</span></span><span class="line"><span class="cl">如果手上的物品大于等于 1 向上跳转 1 行
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="14-灯等灯等灯">14. 灯，等灯等灯</h3>
<h4 id="1-level-0-1">(1) LEVEL 0</h4>
<blockquote>
<p>完整代码见 <a href="code/14.wl">14.wl</a></p>
</blockquote>
<p>从网页的 js 文件中获得 <code>target</code> 矩阵</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">g</span><span class="p">[</span><span class="nv">x_</span><span class="p">,</span><span class="w"> </span><span class="nv">y_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">t</span><span class="p">[</span><span class="nv">x_</span><span class="p">,</span><span class="w"> </span><span class="nv">y_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">If</span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">allC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Flatten</span><span class="o">@</span><span class="n">Table</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eqns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Simplify</span><span class="o">@</span><span class="n">Flatten</span><span class="o">@</span><span class="n">Table</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">target</span><span class="p">[[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">]],</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">FindInstance</span><span class="p">[</span><span class="n">eqns</span><span class="p">,</span><span class="w"> </span><span class="n">allC</span><span class="p">,</span><span class="w"> </span><span class="n">Modulus</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">256</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>我一开始使用了较为复杂的方法（自行编程把变量减少到 24，因为对于这么多含 <code>Mod</code> 的方程，<code>FindInstance</code> 无法解出），后来发现加选项 <code>Modulus -&gt; 256</code> 就可以了。</p>
</blockquote>
<p>然后使用 <code>pyautogui</code> 控制鼠标进行点击</p>
<h3 id="17-micro-world">17. Micro World</h3>
<p>exe 这么大，怀疑是 python，用 IDA 查找字符串证实了这一点</p>
<p>使用 <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> 可以获得 pyc 文件</p>
<p>用 uncompyle6 可以将 pyc 文件转换为 python 源代码，但运行时只有一个点。查阅资料后发现这是 <a href="https://zhuanlan.zhihu.com/p/145811103">代码混淆</a>，pyc 中存在一些跳转指令；里面还指出可以用 dis.dis（更推荐使用 pydisasm）将 pyc 翻译成指令码。</p>
<p>题目描述是</p>
<blockquote>
<p>粒子初始化为 flag，程序记录了一段时间之后的运动情况</p>
</blockquote>
<p>观察大部分正确的 python 代码，发生的应该不是非弹性碰撞（没有出现 0.9 之类的数字）。经测试，直接修改 fps 不会影响到运动状态，所以只能<strong>把各点的速度反向</strong>。</p>
<p>一开始想在较高层面（指令码）修改。将指令码转成 pyc 的工具有 xasm，但这个工具无法处理列表赋值的情况。所以只能<strong>修改 pyc 字节码</strong>。</p>
<p>在 py 文件中修改一些数字的符号，用 <code>python3 -m</code> 生成 pyc 文件。发现对于正数， pyc 中某个字节由 <code>3B</code> 变为 <code>FB</code> ；而对于负数，由 <code>FB</code> 变为 <code>3B</code>。</p>
<p>编写 <a href="code/17/trans.py">trans.py</a> ，主要逻辑如下，把中间间隔 8 个字符的一对 <code>3B</code>/<code>FB</code> 换成相反的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">]</span> <span class="ow">and</span> <span class="n">hold</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">hold</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="n">hold</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">hold</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ansData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ansData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x3F</span> <span class="o">+</span> <span class="mh">0xBF</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>位置不会被改变符号可能是因为其绝对值比较大</p>
</blockquote>
<p>用 <a href="code/17/check.py">check.py</a> 检查指令码，发现多修改了一处，手动改回来。<code>diff</code> 确认指令码没有问题</p>
<p>运行，使用 VLC 录屏并逐帧查看</p>
<center><img src="image/17.png" alt="17" width="50%" /></center>
<h3 id="23-马赛克">23. 马赛克</h3>
<blockquote>
<p>完整代码见 <a href="code/23.wl">23.wl</a></p>
</blockquote>
<p>将二维码的每个模糊的格子视为一个变量。按每个马赛克方块的灰度值列方程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">eqns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Simplify</span><span class="o">@</span><span class="n">Flatten</span><span class="o">@</span><span class="n">Floor</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">expectValue</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">255</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Flatten</span><span class="o">@</span><span class="n">mosaicValue</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Thread</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>对于每一个方程，<strong>将每个变量在 0, 1 范围内枚举</strong>。<strong>若有多个解，取每个解中值都相同的变量</strong></p>
<blockquote>
<p>经试验，单纯地只取有单个解的方程的解，不能做出此题</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">inferSolve</span><span class="p">[</span><span class="nv">eqn_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Module</span><span class="p">[{</span><span class="n">vars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cases</span><span class="p">[</span><span class="n">eqn</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="nv">a_</span><span class="p">,</span><span class="w"> </span><span class="nv">b_</span><span class="p">],</span><span class="w"> </span><span class="n">Infinity</span><span class="p">],</span><span class="w"> </span><span class="n">possible</span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">possible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">#1</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">@@@</span><span class="w"> </span><span class="n">Select</span><span class="p">[</span><span class="nv">#</span><span class="p">[[</span><span class="mi">2</span><span class="p">]]</span><span class="w"> </span><span class="o">&amp;</span><span class="p">]</span><span class="o">@</span><span class="n">Table</span><span class="p">[</span><span class="n">values</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">eqn</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">Thread</span><span class="p">[</span><span class="n">vars</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">values</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">{</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">Tuples</span><span class="p">[{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="n">Length</span><span class="o">@</span><span class="n">vars</span><span class="p">]}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">First</span><span class="w"> </span><span class="o">/@</span><span class="w"> </span><span class="n">Select</span><span class="p">[</span><span class="n">AssociationThread</span><span class="p">[</span><span class="n">vars</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Transpose</span><span class="o">@</span><span class="n">possible</span><span class="p">],</span><span class="w"> </span><span class="n">Equal</span><span class="w"> </span><span class="o">@@</span><span class="w"> </span><span class="nv">#</span><span class="w"> </span><span class="o">&amp;</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Normal</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>将每次确定的解代入方程，进行<strong>迭代</strong>计算。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Table</span><span class="p">[</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inferSolve</span><span class="w"> </span><span class="o">/@</span><span class="w"> </span><span class="n">eqns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Flatten</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Union</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">eqns</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eqns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">Union</span><span class="o">@</span><span class="n">Flatten</span><span class="o">@</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Nothing</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">}];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>虽然还剩余一部分没有解出，但在此 QR 码的容错范围内。</p>
<h3 id="25-密码生成器">25. 密码生成器</h3>
<blockquote>
<p>刚做这题的时候象征性地打开了 IDA 和 x64dbg，由于我不会逆向（比赛前两天才安装）并且也不想逆向，什么都没能发现。</p>
</blockquote>
<p>注意到密码生成器没有提供任何输入，且每次运行都有较长的延迟，更奇怪的是，题目中每句话都不离时间：</p>
<blockquote>
<p>网页显示时间的时区改到了 Asia/Shanghai，我说怎么打印出来总是差 8 个小时。
【由用户 admin 于 2021-09-22 23:40 发布】
【由用户 admin 于 2021-09-22 23:39 发布】
于 2021-09-22 23:11 注册</p>
</blockquote>
<p>怀疑生成的密码和<strong>系统时间</strong>有关。经测试，在相同的秒数会显示相同的密码。</p>
<p>所以将日期调整为 2021 年 9 月 22 日。编写脚本，用 <code>time</code> 命令调整时间（需要管理员权限）至 23:11 附近，用 <code>pyautogui</code> 点击密码生成器的按钮并将输出的密码粘贴到文本编辑器中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyautogui</span> <span class="kn">import</span> <span class="n">click</span><span class="p">,</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">moveTo</span><span class="p">,</span> <span class="n">hotkey</span><span class="p">,</span> <span class="n">press</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">moveTo</span><span class="p">(</span><span class="n">buttonX</span><span class="p">,</span> <span class="n">buttonY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;time 23:10:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">moveTo</span><span class="p">(</span><span class="n">labelX</span><span class="p">,</span> <span class="n">labelY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">hotkey</span><span class="p">(</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">hotkey</span><span class="p">(</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">moveTo</span><span class="p">(</span><span class="n">textX</span><span class="p">,</span> <span class="n">textY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">press</span><span class="p">(</span><span class="s1">&#39;enter&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">hotkey</span><span class="p">(</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后用 <code>pyautogui</code> 输入用户名和密码并进行提交（这样提交比较有仪式感）</p>
<blockquote>
<p>IDA 也就图一乐，真做逆向还得靠 <code>pyautogui</code></p>
</blockquote>
<h3 id="27-just-be-fun">27. JUST BE FUN</h3>
<ul>
<li>解题过程：读代码，写代码（建议将 python 文件中的背景字符换成空格，合理使用 Insert 键），调代码（条件断点）。</li>
<li>此题要求：写一个三维空间的程序，读入 9 以下的数字和 6 种运算符，计算结果。</li>
<li>主要思路：先读一个操作数，读入运算符，按运算符进行分类读入操作数并计算，再读下一个运算符……</li>
</ul>
<p>调试结果为 <a href="code/27/1++">1++</a></p>
<p>由于看了使用说明后仍然不知道如何发送超过 4096 字节的数据，我使用两层的结构把它优化到了 4096 字节以下。两层分别为 <a href="code/27/2-1">2-1</a>	<a href="code/27/2-2">2-2</a></p>
<p>修改后的 python 文件为 <a href="code/27/be_fun+.py">be_fun+.py</a>
由“三维代码”生成 python 输入的文件为  <a href="code/27/generate.wl">generate.wl</a></p>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">GWDx</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2024-06-28
        <a href="https://github.com/GWDx/GWDx.github.io/commit/d7fee4f71facd8080da8dc9eb2c32e23d78e9177" title="启用评论">(d7fee4f)</a>
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/hackergame/">Hackergame</a>
          <a href="/tags/ctf/">CTF</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/hackergame2022/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Hackergame 2022 题解</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/web-tour/">
            <span class="next-text nav-default">Web 之旅</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        


<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'eZM94QLAn3n1uIyq9fgV9U3M-MdYXbMMI',
        appKey: '2l60rnkvKMig2YTvx5OSYETO',
        notify:  false ,
        verify:  false ,
        avatar:'mm',
        placeholder: '',
        visitor:  false ,
        serverURLs : 'https:\/\/ezm94qla.api.lncldglobal.com',
    });
</script>



      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:gwdx@mail.ustc.edu.cn" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/GWDx" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/gan-wen-di" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://space.bilibili.com/442365922" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://gwdx.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2022 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>GWDx</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.5c93b1d90d4bc05350a680cf34fca805c5c13041075057bc584fe6d549c6186a.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-HBL65Q7HB4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HBL65Q7HB4', { 'anonymize_ip': false });
}
</script>







</body>
</html>
